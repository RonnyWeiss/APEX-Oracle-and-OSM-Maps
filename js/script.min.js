var apexOracleOSMMaps = function () { "use strict"; var e = { version: "1.2.7", isDefinedAndNotNull: function (e) { return null != e }, isAPEX: function () { return "undefined" != typeof apex }, debug: { info: function (n) { e.isAPEX() && apex.debug.info(n) }, error: function (n) { e.isAPEX() && apex.debug.error(n) } }, link: function (e, n) { if (!n) return window.location = e; window.open(e, "_blank") }, loader: { start: function (n, r) { if (r || $(n).css("min-height", "100px"), e.isAPEX()) apex.util.showSpinner($(n)); else { var a = $("<span></span>"); a.attr("id", "loader" + n), a.addClass("ct-loader"); var t = $("<i></i>"); t.addClass("fa fa-refresh fa-2x fa-anim-spin"), t.css("background", "rgba(121,121,121,0.6)"), t.css("border-radius", "100%"), t.css("padding", "15px"), t.css("color", "white"), a.append(t), $(n).append(a) } }, stop: function (e) { $(e + " > .u-Processing").remove(), $(e + " > .ct-loader").remove() } }, noDataMessage: { show: function (e, n) { var r = $("<div></div>").css("margin", "12px").css("text-align", "center").css("padding", "64px 0").addClass("nodatafoundmessage"), a = $("<div></div>"), t = $("<span></span>").addClass("fa").addClass("fa-search").addClass("fa-2x").css("height", "32px").css("width", "32px").css("color", "#D0D0D0").css("margin-bottom", "16px"); a.append(t); var o = $("<span></span>").text(n).css("display", "block").css("color", "#707070").css("font-size", "12px"); r.append(a).append(o), $(e).append(r) }, hide: function (e) { $(e).children(".nodatafoundmessage").remove() } }, jsonSaveExtend: function (e, n) { var r = {}, a = {}; if ("string" == typeof n) try { a = JSON.parse(n) } catch (e) { } else a = n; try { r = $.extend(!0, e, a) } catch (n) { r = e } return r } }; return { initialize: function (n, r, a, t, o, i, s) { var d = n + "-c", l = $("#" + n); if (l.length > 0) { var p = {}; p = e.jsonSaveExtend({ refresh: 0, height: "600px", map: { longitude: 0, latitude: 0, zoom: 1 }, marker: { height: 54, width: 54, labels: !1, url: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEeElEQVRogcWZT2hdRRTGf/cRQhYhBAmlhC5CkRBCKCEqVBcSShTRLkSKiJQiLooLF+JCgohQXHThyoVIESkSsuiqiBTRIiolipQS/NcWJG0lVKvV1lBriGnO52LmNjc3d+579915fQeGN+/CzHzfme/MPXNuQk2T+xkAdgOjwEPAFDDsnwP8C1wDvgfOAueBS8CNBKwuhrZNMGhwwOCYYMlgXaB8s63/NwRXBfMGL8oR7Qr4CYNTBr97UNuAlzVz7abBgmBG0LhXwHcKjhjczHs31G+h3TZ435wEOwp+h2BecDsi+LStCz4XjHcS/HEFdB6xfRqdhJfNXChIfVs1uOB36KBgSrBLMGwuXp6RC/ZzBitNdu0LwVg0AgZvpLIJtF8MXhfsEfSUOKIhGBEcNlgsCf4NwYdRAlswZvBXaCGDrwT7BL0V5mwIJv1urQV2Y9Vgf13wAwYnbfPYy3vpuGBnjfn7BG8arBXJyZzcRuoQ2C+4GjhVztQBnyVhTi7b5GRwy+DlMlmWTdwveCeg02XBTF3wmbUmBN8GAvqjthwlGBf8VOCVNYMjVTTfzMytdyiNNdsqoxXBdGhsWZTvFtxf8PxKAh8n8F9d4DkQnwEXBSS++f4A8GCTsYU2mXgva+vz87isMrZdS+DLJPMg0384NKiMwAMFE5HA6Zjez61xCpzDUqf5/mRoXBmBUOBcrIyudSuSEJSk3EECgv5MP2t/1EHYxP5O4E76J9n87QsNCJ6vAS3eE0sdlmz2g7e2shfEjcDzoXZAtWgDgp7UYRkJ/RMaUBYDl9JOTkKdvHSMFu28MljyVkZgIT+Rn+yxmC+xzLwAT6X97CmUwNehcWVB/KPgz/zzBCbozK1pCJguOIXuAGdCg4IEEvg18S+snIRGgCfaSrAC5iN0HzBeIKErci/PaiboEcwKVgvy9SXBo7WRezMYlbtX5POuDcF72qwvVSaxV/BzJrHKLnBacF8E8L0e5HrBneC64Dk1nyZIoE8wV5BOpxead+uQ8OBflSurFN2PFwx2tDt/SmLCwgtsCD4RPFIlJnz6PC53yV8tcdCBWuAzJE4UxMHdX4MLBq/IabnsZEMwLFe1WAjIJm2LKkkhqhKYlqtnBus5BrcE33mvPi0YNRiUe7uOCB4XvC34RpmLSxF4c7tyKAp4T6BP8FbgRGrar9J87WlOsVMWwZjgbBXgbfYvy5Vp4ppBw5x22/Fqlf7RaNoPEJm3TKUipoTM7XDnwHsCk4LFDkhoWXUrca2YoNfgsMLlxnYktOql098cQRwSPYKj5mqjMSR0QhHSkqokhvznoboSuqyYpfSKJGY8gHYltGLwQlfAewINuWzxt6oS8oXb1zp+6rRAok8wW5Ryl/UNPlBnCwStm1y+c7KChH5Qt74Ph0ywy1wpfD0kIf8CPCfY022820yuTcllmyHZLAmeVMT7dFTzQb3X/EfwHJF1g2fVgZJMdJPL/ZcyJK4LXuo2rpbN33WfFyz73ZhVu5WFbpk/Xg/KfYUc7NQ6/wPXO1op+IbpEgAAAABJRU5ErkJggg==" } }, a); var A = function (e) { var n = $("<div></div>"); return n.addClass("aom-container"), n.attr("id", d), n.height(p.height), e.append(n), n }(l); M(); try { apex.jQuery("#" + o).bind("apexrefresh", (function () { 0 == A.children("span").length && M() })) } catch (e) { } p.refresh > 0 && setInterval((function () { 0 == A.children("span").length && M() }), 1e3 * p.refresh) } function u(n) { A.empty(), e.debug.info({ data: n, configJSON: p }); var r = p.map.longitude, a = p.map.latitude, t = p.map.zoom; if ("oracle" === s) try { OM.gv.setResourcePath(i + "/jslib/v2.3/"), OM.gv.setBaseMapViewerURL(i), OM.Map.setLocale("en"), e.debug.info({ map: OM }); var o = 8307, l = new OM.universe.Universe({ srid: o, bounds: new OM.geometry.Rectangle(-180, -65, 180, 65, o), numberOfZoomLevels: 5 }), u = document.getElementById(d), M = { mapviewerURL: i, universe: l }, c = new OM.Map(u, M), g = new OM.layer.ElocationTileLayer("map"), L = { def: { type: OM.layer.VectorLayer.TYPE_LOCAL } }, f = new OM.layer.VectorLayer("vectors", L); n.row && n.row.length > 0 && $.each(n.row, (function (n, o) { var i; if (0 === n && (e.isDefinedAndNotNull(o.MAP_LONGITUDE) && "" != o.MAP_LONGITUDE && (e.debug.info({ MapLongitude_o: o.MAP_LONGITUDE }), r = parseFloat(o.MAP_LONGITUDE.toString().replace(/,/, ".")), e.debug.info({ MapLongitude: r })), e.isDefinedAndNotNull(o.MAP_LATITUDE) && "" != o.MAP_LATITUDE && (e.debug.info({ MapLatitude_o: o.MAP_LATITUDE }), a = parseFloat(o.MAP_LATITUDE.toString().replace(/,/, ".")), e.debug.info({ MapLongitude: a })), e.isDefinedAndNotNull(o.MAP_ZOOM) && "" != o.MAP_ZOOM && (e.debug.info({ MapZoom_o: o.MAP_ZOOM }), t = parseFloat(o.MAP_ZOOM.toString().replace(/,/, ".")), e.debug.info({ MapZoom: t }))), e.isDefinedAndNotNull(o.MARKER_LABEL) && (i = o.MARKER_LABEL.toString()), e.isDefinedAndNotNull(o.MARKER_LATITUDE) && "" != o.MARKER_LATITUDE && e.isDefinedAndNotNull(o.MARKER_LONGITUDE) && "" != o.MARKER_LONGITUDE) { e.debug.info({ MarkerLongitude_o: o.MARKER_LONGITUDE, MarkerLatitude_o: o.MARKER_LATITUDE }); var s = parseFloat(o.MARKER_LONGITUDE.toString().replace(/,/, ".")), d = parseFloat(o.MARKER_LATITUDE.toString().replace(/,/, ".")); e.debug.info({ MarkerLongitude: s, MarkerLatitude: d }); var l = new OM.geometry.Point(s, d), A = new OM.Feature(o.MARKER_LABEL || n, l, { label: i, renderingStyle: new OM.style.Marker({ src: o.MARKER_URL || p.marker.url, width: o.MARKER_WIDTH || p.marker.width, height: o.MARKER_HEIGHT || p.marker.height }) }); f.addFeature(A), e.isDefinedAndNotNull(o.MARKER_LINK) && A.addListener("click", (function () { e.link(o.MARKER_LINK) })) } })), f.setLabelsVisible(p.marker.labels), c.addLayer(g), n.row && n.row.length > 0 && c.addLayer(f); var E = new OM.geometry.Point(r, a, o); c.setMapCenterAndZoomLevel(E, t, !0), c.init() } catch (n) { e.debug.error("Erro while try to draw Oracle maps"), e.debug.error(n) } else try { var w = new OpenLayers.Layer.OSM.Mapnik("Mapnik", { attribution: 'Â© <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> Copyright' }); function o(e) { return 20037508.34 * e / 180 } function i(e) { var n = 3.141592653589793; return 20037508.34 * (e = Math.log(Math.tan((90 + e) * n / 360)) / (n / 180)) / 180 } function s(n, r, a, t, s, d, l, A) { var u = new OpenLayers.LonLat(o(r), i(a)), M = s || p.marker.width, c = d || p.marker.height, g = new OpenLayers.Size(M, c), L = new OpenLayers.Pixel(-g.w / 2, -g.h), f = t || p.marker.url, E = new OpenLayers.Icon(f, g, L), w = new OpenLayers.Feature(n, u), R = new OpenLayers.Marker(u, E); e.isDefinedAndNotNull(A) && (R.icon.imageDiv.title = A), R.feature = w, n.addMarker(R), e.isDefinedAndNotNull(l) && R.events.register("click", n, (function () { e.link(l) })) } if (OpenLayers.Lang.setCode("en"), c = new OpenLayers.Map(d, { projection: new OpenLayers.Projection("EPSG:900913"), displayProjection: new OpenLayers.Projection("EPSG:4326"), maxExtent: new OpenLayers.Bounds(-20037508.34, -20037508.34, 20037508.34, 20037508.34), numZoomLevels: 18, maxResolution: 156543, units: "meters" }), n.row && n.row.length > 0) $.each(n.row, (function (n, o) { 0 === n && (e.isDefinedAndNotNull(o.MAP_LONGITUDE) && "" != o.MAP_LONGITUDE && (e.debug.info({ MapLongitude_o: o.MAP_LONGITUDE }), r = parseFloat(o.MAP_LONGITUDE.toString().replace(/,/, ".")), e.debug.info({ MapLongitude: r })), e.isDefinedAndNotNull(o.MAP_LATITUDE) && "" != o.MAP_LATITUDE && (e.debug.info({ MapLatitude_o: o.MAP_LATITUDE }), a = parseFloat(o.MAP_LATITUDE.toString().replace(/,/, ".")), e.debug.info({ MapLongitude: a })), e.isDefinedAndNotNull(o.MAP_ZOOM) && "" != o.MAP_ZOOM && (e.debug.info({ MapZoom_o: o.MAP_ZOOM }), t = parseFloat(o.MAP_ZOOM.toString().replace(/,/, ".")), e.debug.info({ MapZoom: t }))); var i = new OpenLayers.Layer.Markers("Address", { projection: new OpenLayers.Projection("EPSG:4326"), visibility: !0, displayInLayerSwitcher: !1 }); if (e.isDefinedAndNotNull(o.MARKER_LATITUDE) && "" != o.MARKER_LATITUDE && e.isDefinedAndNotNull(o.MARKER_LONGITUDE) && "" != o.MARKER_LONGITUDE) { e.debug.info({ MarkerLongitude_o: o.MARKER_LONGITUDE, MarkerLatitude_o: o.MARKER_LATITUDE }); var d = parseFloat(o.MARKER_LONGITUDE.toString().replace(/,/, ".")), l = parseFloat(o.MARKER_LATITUDE.toString().replace(/,/, ".")); e.debug.info({ MarkerLongitude: d, MarkerLatitude: l }), s(i, d, l, o.MARKER_URL, o.MARKER_WIDTH, o.MARKER_HEIGHT, o.MARKER_LINK, o.MARKER_LABEL) } c.addLayers([w, i]) })); else { e.debug.info("No SQL Data loaded."); var R = new OpenLayers.Layer.Markers("Address", { projection: new OpenLayers.Projection("EPSG:4326"), visibility: !0, displayInLayerSwitcher: !1 }); c.addLayers([w, R]) } var h = o(r), O = i(a); c.setCenter(new OpenLayers.LonLat(h, O), t + 1), A.find(".olControlAttribution").css("bottom", "5px") } catch (n) { e.debug.error("Erro while try to draw OpenStreetMaps"), e.debug.error(n) } } function M() { e.loader.start(A); var n = t; apex.server.plugin(r, { pageItems: n }, { success: u, error: function (n) { A.empty(), e.noDataMessage.show("#" + d, "Error occured!") }, dataType: "json" }) } } } }();